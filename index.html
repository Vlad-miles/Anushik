<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥–ª—è —Å–∞–º–æ–π –ª—é–±–∏–º–æ–π</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Telegram-friendly —Å—Ç–∏–ª–∏ */
        :root {
            --tg-bg: #0f0f0f;
            --tg-text: #ffffff;
            --tg-hint: #aaaaaa;
            --tg-accent: #8774e1;
            --tg-accent-light: #a396e6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--tg-bg);
            color: var(--tg-text);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .screen {
            display: none;
            min-height: 100vh;
            padding: 30px 20px;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            animation: fadeIn 0.8s ease;
        }
        
        .screen.active {
            display: flex;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #ff6b9d, var(--tg-accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 700;
        }
        
        h2 {
            font-size: 2rem;
            margin-bottom: 25px;
            color: var(--tg-accent-light);
        }
        
        p {
            font-size: 1.3rem;
            margin-bottom: 25px;
            max-width: 600px;
        }
        
        .btn {
            background: var(--tg-accent);
            color: white;
            border: none;
            padding: 18px 45px;
            font-size: 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            margin: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(135, 116, 225, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(135, 116, 225, 0.4);
            background: var(--tg-accent-light);
        }
        
        .btn:active {
            transform: translateY(-2px);
        }
        
        .password-input {
            padding: 18px 25px;
            font-size: 1.3rem;
            border: 3px solid var(--tg-accent);
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--tg-text);
            width: 90%;
            max-width: 400px;
            margin: 25px 0;
            text-align: center;
            outline: none;
        }
        
        .password-input:focus {
            border-color: #ff6b9d;
            box-shadow: 0 0 20px rgba(255, 107, 157, 0.3);
        }
        
        .countdown {
            font-family: 'Courier New', monospace;
            font-size: 3rem;
            margin: 30px 0;
            color: #ffcc00;
            text-shadow: 0 0 15px rgba(255, 204, 0, 0.5);
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            min-width: 300px;
        }
        
        .heart {
            color: #ff6b9d;
            font-size: 3rem;
            margin: 25px;
            animation: heartbeat 1.5s infinite;
        }
        
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        .photo-frame {
            width: 220px;
            height: 220px;
            border-radius: 50%;
            overflow: hidden;
            margin: 30px;
            border: 6px solid var(--tg-accent);
            box-shadow: 0 0 40px rgba(135, 116, 225, 0.5);
            position: relative;
        }
        
        .photo-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .invitation-card {
            background: linear-gradient(135deg, rgba(135, 116, 225, 0.15), rgba(255, 107, 157, 0.1));
            border-radius: 25px;
            padding: 35px;
            margin: 30px;
            max-width: 500px;
            border: 2px solid var(--tg-accent);
            backdrop-filter: blur(10px);
        }
        
        .detail-item {
            display: flex;
            align-items: center;
            margin: 15px 0;
            font-size: 1.2rem;
        }
        
        .detail-item i {
            width: 40px;
            color: var(--tg-accent);
            font-size: 1.5rem;
        }
        
        .typed-text {
            font-size: 1.5rem;
            min-height: 200px;
            margin: 30px 0;
            line-height: 1.8;
        }
        
        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            background: var(--tg-accent);
            border-radius: 50%;
            opacity: 0;
            pointer-events: none;
            z-index: 1000;
        }
        
        .error-message {
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            padding: 15px;
            border-radius: 15px;
            margin: 20px;
            display: none;
        }
        
        /* –ê—É–¥–∏–æ-–∫–æ–Ω—Ç—Ä–æ–ª—ã */
        .audio-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(135, 116, 225, 0.3);
        }
        
        .audio-btn {
            background: transparent;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .audio-btn:hover {
            background: rgba(135, 116, 225, 0.2);
        }
        
        .volume-slider {
            width: 80px;
            height: 4px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            outline: none;
        }
        
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--tg-accent);
            cursor: pointer;
        }
        
        /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
        @media (max-width: 768px) {
            h1 { font-size: 2.2rem; }
            h2 { font-size: 1.7rem; }
            p { font-size: 1.1rem; }
            .countdown { font-size: 2.2rem; min-width: 250px; }
            .btn { padding: 16px 35px; font-size: 1.1rem; }
            .invitation-card { padding: 25px; margin: 15px; }
            .audio-controls {
                bottom: 10px;
                right: 10px;
                padding: 8px 12px;
            }
            .volume-slider {
                width: 60px;
            }
        }
    </style>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω 1: –ó–∞–≥—Ä—É–∑–∫–∞ -->
    <div id="screen1" class="screen active">
        <div class="heart"><i class="fas fa-heart"></i></div>
        <h1 id="loading-title">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è...</h1>
        <p>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–æ–ª—à–µ–±—Å—Ç–≤–∞ –¥–ª—è —Ç–µ–±—è <span id="her-name">[–ò–º—è]</span></p>
        <div class="countdown" id="countdown-timer">00:00:00</div>
        <div class="error-message" id="error-msg">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.</div>
    </div>
    
    <!-- –≠–∫—Ä–∞–Ω 2: –ü–∞—Ä–æ–ª—å -->
    <div id="screen2" class="screen">
        <h2><i class="fas fa-lock"></i> –°–µ–∫—Ä–µ—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø</h2>
        <p>–≠—Ç–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∑–∞—â–∏—â–µ–Ω–æ –ø–∞—Ä–æ–ª–µ–º</p>
        <p><em>–ö–∞–∫ —è –æ–±—ã—á–Ω–æ –Ω–∞–∑—ã–≤–∞—é —Ç–µ–±—è ?</em></p>
        <input type="text" id="password-input" class="password-input" placeholder="–í–≤–µ–¥–∏ —Å–ª–æ–≤–æ..." autocomplete="off">
        <button class="btn" onclick="checkPassword()"><i class="fas fa-key"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
        <p id="password-hint" style="color:#ffcc00; display:none;">–í–µ—Ä–Ω–æ! –¢—ã –Ω–∞–≤—Å–µ–≥–¥–∞ –º–æ—è –º—ã—à—å —Å –º—ã—à—Ü–µ–π ‚ù§Ô∏è</p>
    </div>
    
    <!-- –≠–∫—Ä–∞–Ω 3: –ö–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã -->
    <div id="screen3" class="screen">
        <div class="photo-frame">
            <!-- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ñ–æ—Ç–æ -->
            <img src="couple.jpg" alt="–ù–∞—à–µ —Ñ–æ—Ç–æ" id="couple-photo">
        </div>
        <h2><i class="fas fa-star"></i> –î–ª—è —Å–∞–º–æ–π –æ—Å–æ–±–µ–Ω–Ω–æ–π</h2>
        <div id="typed-compliments" class="typed-text"></div>
        <button class="btn" onclick="showScreen(4)"><i class="fas fa-arrow-right"></i> –£–∑–Ω–∞—Ç—å –º–µ—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∏</button>
    </div>
    
    <!-- –≠–∫—Ä–∞–Ω 4: –ó–∞–≥–∞–¥–∫–∞ –º–µ—Å—Ç–∞ -->
    <div id="screen4" class="screen">
        <h2><i class="fas fa-map-marker-alt"></i> –ü–æ–∏—Å–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç</h2>
        <p>–ú–µ—Å—Ç–æ –Ω–∞—à–µ–π –≤—Å—Ç—Ä–µ—á–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ –≤ –∑–∞–≥–∞–¥–∫–µ:</p>
        <div class="invitation-card">
            <p id="location-riddle">
               –¢–∞–º –ø–∞–ª–æ—á–∫–∏ —Ä–∏—Å—É—é—Ç –∏–µ—Ä–æ–≥–ª–∏—Ñ ¬´–ª—é–±–æ–≤—å¬ª,<br>
             –ê –ª–æ—Å–æ—Å—å –Ω–∞ —Ä–∏—Å–µ ‚Äî –∫–∞–∫ –∑–∞–∫–∞—Ç –Ω–∞ –ø–æ–¥—É—à–∫–µ.<br>
                –í <strong id="riddle-time">19:30</strong> –∂–¥—É —Ç–µ–±—è, –º–æ–π —Å–≤–µ—Ç,<br>
               –ß—Ç–æ–±—ã —ç—Ç–æ—Ç –≤–µ—á–µ—Ä –ø–∞—Ö —á–∞–µ–º –∏ —Å—á–∞—Å—Ç—å–µ–º.
            </p>
        </div>
        <button class="btn" onclick="showScreen(5)"><i class="fas fa-map"></i> –†–∞—Å–∫—Ä—ã—Ç—å –≤—Å–µ –¥–µ—Ç–∞–ª–∏</button>
    </div>
    
    <!-- –≠–∫—Ä–∞–Ω 5: –§–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ -->
    <div id="screen5" class="screen">
        <h1><i class="fas fa-gift"></i> –í—Å—ë –≥–æ—Ç–æ–≤–æ!</h1>
        <div class="invitation-card">
            <h2 id="final-location">–†–µ—Å—Ç–æ—Ä–∞–Ω "–ö–∞–º–∏–∫–æ"</h2>
            
            <div class="detail-item">
                <i class="fas fa-calendar-alt"></i>
                <span><strong>–î–∞—Ç–∞:</strong> <span id="final-date">12 –¥–µ–∫–∞–±—Ä—è 2025</span></span>
            </div>
            
            <div class="detail-item">
                <i class="fas fa-clock"></i>
                <span><strong>–í—Ä–µ–º—è:</strong> <span id="final-time" style="font-size:1.4rem; color:#ffcc00;">19:30</span></span>
            </div>
            
            <div class="detail-item">
                <i class="fas fa-map-pin"></i>
                <span><strong>–ê–¥—Ä–µ—Å:</strong> <span id="final-address">—É–ª. –†–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è, 42</span></span>
            </div>
            
            <div class="detail-item">
                <i class="fas fa-tshirt"></i>
                <span><strong>–î—Ä–µ—Å—Å-–∫–æ–¥:</strong> <span id="final-dress-code">–¢–≤–æ–π –∫—Ä–∞—Å–∏–≤—ã–π –ª—É—á–æ–∫</span></span>
            </div>
            
            <div class="detail-item" style="color:#ffcc00; margin-top:25px;">
                <i class="fas fa-surprise"></i>
                <span><em id="final-secret">–ú–æ–∂–µ–º —Å–∏–ª—å–Ω–æ –Ω–µ –æ–±—ä–µ–¥–∞—Ç—å—Å—è –∏–ª–∏ –∫—É–ø–∏—Ç—å –ø–æ–∫–µ</em></span>
            </div>
        </div>
        
        <button class="btn" onclick="acceptInvitation()" id="accept-btn" 
                style="background: linear-gradient(45deg, #4CAF50, #45a049);">
            <i class="fas fa-check-circle"></i> –Ø —Å –æ–≥—Ä–æ–º–Ω–æ–π —Ä–∞–¥–æ—Å—Ç—å—é –ø—Ä–∏–¥—É!
        </button>
        
        <div class="heart"><i class="fas fa-heart"></i></div>
    </div>
    
    <!-- –ê—É–¥–∏–æ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    <div class="audio-controls" id="audioControls">
        <button class="audio-btn" id="audioToggle" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É">üîá</button>
        <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.1" value="0.6" title="–ì—Ä–æ–º–∫–æ—Å—Ç—å">
    </div>

    <script>
        // ==================== –ú–£–ó–´–ö–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê (–õ–û–ö–ê–õ–¨–ù–´–ï –§–ê–ô–õ–´) ====================
        // –ü—É—Ç–∏ –∫ –ª–æ–∫–∞–ª—å–Ω—ã–º –º—É–∑—ã–∫–∞–ª—å–Ω—ã–º —Ñ–∞–π–ª–∞–º –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
        const MUSIC_TRACKS = {
            secret: 'music/secret.mp3',        // –ù–∞–ø—Ä—è–∂–µ–Ω–Ω–∞—è –º—É–∑—ã–∫–∞
            romantic: 'music/romantic.mp3',    // –†–æ–º–∞–Ω—Ç–∏—á–Ω–∞—è –º—É–∑—ã–∫–∞
            adventure: 'music/adventure.mp3',  // –ü—Ä–∏–∫–ª—é—á–µ–Ω—á–µ—Å–∫–∞—è
            celebration: 'music/celebration.mp3' // –ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è
        };
        
        let audioPlayer = null;
        let currentTrack = 'secret';
        let isMusicPlaying = false;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ
        function initAudioSystem() {
            audioPlayer = new Audio(MUSIC_TRACKS.secret);
            audioPlayer.loop = true;
            audioPlayer.volume = 0.6;
            
            // –ö–Ω–æ–ø–∫–∞ –≤–∫–ª/–≤—ã–∫–ª
            document.getElementById('audioToggle').addEventListener('click', toggleMusic);
            
            // –°–ª–∞–π–¥–µ—Ä –≥—Ä–æ–º–∫–æ—Å—Ç–∏
            document.getElementById('volumeSlider').addEventListener('input', (e) => {
                audioPlayer.volume = e.target.value;
            });
            
            // –ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ª—é–±—É—é –∫–Ω–æ–ø–∫—É
            document.addEventListener('click', startMusicOnInteraction);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ —Ç—Ä–µ–∫–∏ –∑–∞—Ä–∞–Ω–µ–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
            preloadMusicTracks();
            
            console.log("üéµ –ú—É–∑—ã–∫–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã)");
        }
        
        // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –º—É–∑—ã–∫–∏ –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
        function preloadMusicTracks() {
            Object.values(MUSIC_TRACKS).forEach(src => {
                const audio = new Audio();
                audio.src = src;
                audio.load();
                console.log(`üéµ –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω —Ç—Ä–µ–∫: ${src}`);
            });
        }
        
        // –ó–∞–ø—É—Å–∫ –º—É–∑—ã–∫–∏ –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function startMusicOnInteraction(e) {
            if (!isMusicPlaying && audioPlayer) {
                audioPlayer.play().then(() => {
                    isMusicPlaying = true;
                    updateAudioButton();
                    console.log("üéµ –ú—É–∑—ã–∫–∞ –∑–∞–ø—É—â–µ–Ω–∞");
                }).catch(err => {
                    console.log("–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ, –∂–¥—ë–º –∫–ª–∏–∫–∞...");
                });
                
                // –£–¥–∞–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
                if (isMusicPlaying) {
                    document.removeEventListener('click', startMusicOnInteraction);
                }
            }
        }
        
        // –°–º–µ–Ω–∞ –º—É–∑—ã–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —ç–∫—Ä–∞–Ω–∞
        function changeMusicForScreen(screenNumber) {
            let track = 'secret';
            
            switch(screenNumber) {
                case 1:
                case 2:
                    track = 'secret';      // –ù–∞–ø—Ä—è–∂–µ–Ω–Ω–∞—è –º—É–∑—ã–∫–∞
                    break;
                case 3:
                    track = 'romantic';    // –†–æ–º–∞–Ω—Ç–∏—á–Ω–∞—è –º—É–∑—ã–∫–∞
                    break;
                case 4:
                    track = 'adventure';   // –ü—Ä–∏–∫–ª—é—á–µ–Ω—á–µ—Å–∫–∞—è –º—É–∑—ã–∫–∞
                    break;
                case 5:
                    track = 'celebration'; // –ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è –º—É–∑—ã–∫–∞
                    break;
            }
            
            if (currentTrack !== track && isMusicPlaying) {
                changeMusicTrack(track);
            }
        }
        
        // –ü–ª–∞–≤–Ω–∞—è —Å–º–µ–Ω–∞ —Ç—Ä–µ–∫–∞
        function changeMusicTrack(newTrack, fadeDuration = 1500) {
            if (!audioPlayer || currentTrack === newTrack) return;
            
            console.log(`üéµ –°–º–µ–Ω–∞ –º—É–∑—ã–∫–∏: ${currentTrack} -> ${newTrack}`);
            
            const oldVolume = audioPlayer.volume;
            const fadeSteps = 20;
            const stepTime = fadeDuration / fadeSteps;
            const volumeStep = oldVolume / fadeSteps;
            
            // –ü–ª–∞–≤–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏
            let fadeOutInterval = setInterval(() => {
                if (audioPlayer.volume > volumeStep) {
                    audioPlayer.volume -= volumeStep;
                } else {
                    clearInterval(fadeOutInterval);
                    
                    // –ú–µ–Ω—è–µ–º —Ç—Ä–µ–∫ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª
                    audioPlayer.src = MUSIC_TRACKS[newTrack];
                    audioPlayer.play().catch(e => {
                        console.log(`–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è ${newTrack}:`, e);
                        // –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–±—É–µ–º –æ–Ω–ª–∞–π–Ω-–∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
                        audioPlayer.src = getFallbackTrack(newTrack);
                        audioPlayer.play();
                    });
                    
                    currentTrack = newTrack;
                    
                    // –ü–ª–∞–≤–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏
                    let currentVol = 0;
                    let fadeInInterval = setInterval(() => {
                        if (currentVol < oldVolume) {
                            currentVol += volumeStep;
                            audioPlayer.volume = currentVol;
                        } else {
                            clearInterval(fadeInInterval);
                        }
                    }, stepTime);
                }
            }, stepTime);
        }
        
        // –ó–∞–ø–∞—Å–Ω—ã–µ –æ–Ω–ª–∞–π–Ω-—Ç—Ä–µ–∫–∏ (–µ—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã)
        function getFallbackTrack(trackName) {
            const fallbackTracks = {
                secret: 'https://assets.mixkit.co/music/preview/mixkit-sci-fi-suspense-729.mp3',
                romantic: 'https://assets.mixkit.co/music/preview/mixkit-a-love-to-cherish-531.mp3',
                adventure: 'https://assets.mixkit.co/music/preview/mixkit-exploring-the-world-523.mp3',
                celebration: 'https://assets.mixkit.co/music/preview/mixkit-happy-celebration-567.mp3'
            };
            console.log(`üéµ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–Ω–ª–∞–π–Ω-–∑–∞–ø–∞—Å–Ω–æ–π —Ç—Ä–µ–∫ –¥–ª—è ${trackName}`);
            return fallbackTracks[trackName] || fallbackTracks.secret;
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º—É–∑—ã–∫–∏ –≤–∫–ª/–≤—ã–∫–ª
        function toggleMusic() {
            if (!audioPlayer) return;
            
            if (isMusicPlaying) {
                audioPlayer.pause();
                isMusicPlaying = false;
            } else {
                audioPlayer.play().then(() => {
                    isMusicPlaying = true;
                }).catch(err => {
                    console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º—É–∑—ã–∫–∏:", err);
                });
            }
            
            updateAudioButton();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –∫–Ω–æ–ø–∫–∏
        function updateAudioButton() {
            const btn = document.getElementById('audioToggle');
            if (isMusicPlaying) {
                btn.innerHTML = 'üîä';
                btn.title = '–í—ã–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É';
            } else {
                btn.innerHTML = 'üîá';
                btn.title = '–í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É';
            }
        }
        
        // ==================== –û–†–ò–ì–ò–ù–ê–õ–¨–ù–´–ô –ö–û–î –ü–†–ò–ì–õ–ê–®–ï–ù–ò–Ø ====================
        let invitationData = {};
        let countdownInterval;
        
        document.addEventListener('DOMContentLoaded', async function() {
            console.log("üöÄ –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...");
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∞—É–¥–∏–æ —Å–∏—Å—Ç–µ–º—É
            initAudioSystem();
            
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
                const response = await fetch('/api/invitation');
                if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                
                invitationData = await response.json();
                console.log("‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:", invitationData);
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                document.getElementById('her-name').textContent = invitationData.her_name;
                document.getElementById('loading-title').textContent = `–î–ª—è ${invitationData.her_name}`;
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
                startCountdown();
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    document.getElementById('error-msg').style.display = 'none';
                    showScreen(2);
                }, 2000);
                
            } catch (error) {
                console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:", error);
                document.getElementById('error-msg').style.display = 'block';
                
                // –ó–∞–ø–∞—Å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                invitationData = {
                    her_name: "–ê–Ω–Ω–∞",
                    your_name: "–í–ª–∞–¥",
                    date: "12 –¥–µ–∫–∞–±—Ä—è 2025",
                    time: "19:30",
                    location: { name: "–ö–∞–º–∏–∫–æ", address: "–°–æ–≤–µ—Ç—Å–∫–∞—è —É–ª–∏—Ü–∞, 58" },
                    dress_code: "–¢–≤–æ—ë —Å–∞–º–æ–µ –∫—Ä–∞—Å–∏–≤–æ–µ –ø–ª–∞—Ç—å–µ",
                    secret: "–ú–æ–∂–µ–º —Å–∏–ª—å–Ω–æ –Ω–µ –æ–±—ä–µ–¥–∞—Ç—å—Å—è –∏–ª–∏ –∫—É–ø–∏—Ç—å –ø–æ–∫–µ",
                    password: "–ú—ã—à–∫–∞",
                    event_date: "2025-12-12T19:30:00"
                };
                
                // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –∑–∞–ø–∞—Å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                setTimeout(() => showScreen(2), 2000);
            }
        });
        
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —ç–∫—Ä–∞–Ω–∞–º
        function showScreen(screenNumber) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω
            const targetScreen = document.getElementById(`screen${screenNumber}`);
            targetScreen.classList.add('active');
            
            // –ú–µ–Ω—è–µ–º –º—É–∑—ã–∫—É –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
            changeMusicForScreen(screenNumber);
            
            // –û—Å–æ–±—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤
            switch(screenNumber) {
                case 3:
                    startTypingAnimation();
                    break;
                case 5:
                    updateFinalDetails();
                    break;
            }
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–≤–µ—Ä—Ö
            window.scrollTo(0, 0);
        }
        
        // –¢–∞–π–º–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞
        function startCountdown() {
            const eventDate = new Date(invitationData.event_date).getTime();
            const countdownEl = document.getElementById('countdown-timer');
            
            function updateTimer() {
                const now = new Date().getTime();
                const diff = eventDate - now;
                
                if (diff > 0) {
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                    
                    if (days > 0) {
                        countdownEl.textContent = `${days}–¥ ${hours}—á ${minutes}–º`;
                    } else {
                        countdownEl.textContent = 
                            `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    }
                } else {
                    countdownEl.textContent = "–ü—Ä—è–º–æ —Å–µ–π—á–∞—Å!";
                    clearInterval(countdownInterval);
                }
            }
            
            updateTimer();
            countdownInterval = setInterval(updateTimer, 1000);
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
        function checkPassword() {
            const input = document.getElementById('password-input').value.trim().toLowerCase();
            const correctPassword = invitationData.password.toLowerCase();
            const hintEl = document.getElementById('password-hint');
            
            if (input === correctPassword) {
                hintEl.style.display = 'block';
                hintEl.innerHTML = `–í–µ—Ä–Ω–æ! –¢—ã –Ω–∞–≤—Å–µ–≥–¥–∞ –º–æ—è ${correctPassword} ‚ù§Ô∏è`;
                
                // –ö—Ä–∞—Å–∏–≤—ã–π –ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    showScreen(3);
                }, 1500);
            } else {
                hintEl.style.display = 'block';
                hintEl.innerHTML = '–ù–µ —Å–æ–≤—Å–µ–º... –¢—É—Ç —É–º–µ–Ω—å—à–∏—Ç–µ–ª—å–Ω–∞—è –ª–∞—Å–∫–∞—Ç–µ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞, –º...—å';
                hintEl.style.color = '#ff6b6b';
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    hintEl.style.display = 'none';
                    document.getElementById('password-input').value = '';
                    document.getElementById('password-input').focus();
                }, 2000);
            }
        }
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—á–∞—Ç–∞—é—â–µ–≥–æ—Å—è —Ç–µ–∫—Å—Ç–∞ (–∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã)
        function startTypingAnimation() {
compliments = [
    "–î–æ—Ä–æ–≥–æ–π –ê–Ω—É—à–∏–∫ =) –Ø —Ç–µ–±—è –ª—é–±–ª—é!",
    "–¢–≤–æ—è —É–ª—ã–±–∫–∞ –¥–ª—è –º–µ–Ω—è ‚Äî –∫–∞–∫ —Å–æ–ª–Ω—Ü–µ –≤ –ø–∞—Å–º—É—Ä–Ω—ã–π –¥–µ–Ω—å",
    "–Ø –ª—é–±–ª—é –∏–º–µ–Ω–Ω–æ –¢–ï–ë–Ø ‚Äî –Ω–∞—Å—Ç–æ—è—â—É—é, –Ω–µ–ø–æ–≤—Ç–æ—Ä–∏–º—É—é",
    "–¢–≤–æ–∏ –ø–∞—Ä–æ–¥–∏–∏ –Ω–∞ –º–µ–º—ã –∏ —Ç–∏–∫—Ç–æ–∫–∏ ‚Äî —ç—Ç–æ —Ü–µ–ª—ã–π –º–∏—Ä —ç–º–æ—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–π —Ç—ã –¥–∞—Ä–∏—à—å –º–Ω–µ —É—Å–∏–ª–∏–≤–∞—è –∏—Ö —Å—É—Ç—å"
];
            
            const typedEl = document.getElementById('typed-compliments');
            let lineIndex = 0;
            let charIndex = 0;
            
            function typeLine() {
                if (lineIndex < compliments.length) {
                    if (charIndex < compliments[lineIndex].length) {
                        typedEl.innerHTML += compliments[lineIndex].charAt(charIndex);
                        charIndex++;
                        setTimeout(typeLine, 50);
                    } else {
                        typedEl.innerHTML += '<br><br>';
                        lineIndex++;
                        charIndex = 0;
                        setTimeout(typeLine, 800);
                    }
                }
            }
            
            typedEl.innerHTML = '';
            typeLine();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –¥–µ—Ç–∞–ª–µ–π
        function updateFinalDetails() {
            document.getElementById('final-location').textContent = invitationData.location.name;
            document.getElementById('final-date').textContent = invitationData.date;
            document.getElementById('final-time').textContent = invitationData.time;
            document.getElementById('final-address').textContent = invitationData.location.address;
            document.getElementById('final-dress-code').textContent = invitationData.dress_code;
            document.getElementById('final-secret').textContent = invitationData.secret;
            document.getElementById('riddle-time').textContent = invitationData.time;
        }
        
        // –ü—Ä–∏–Ω—è—Ç–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
        function acceptInvitation() {
            const btn = document.getElementById('accept-btn');
            const originalText = btn.innerHTML;
            
            // –ú–µ–Ω—è–µ–º –∫–Ω–æ–ø–∫—É
            btn.innerHTML = '<i class="fas fa-heart"></i> –ñ–¥—É —Ç–µ–±—è —Å –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏–µ–º, –º–æ–π –ê–Ω—É—à–∏–∫';
            btn.style.background = 'linear-gradient(45deg, #4CAF50, #2E7D32)';
            btn.disabled = true;
            
            // –£—Å–∏–ª–∏–≤–∞–µ–º –º—É–∑—ã–∫—É –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
            if (audioPlayer && isMusicPlaying) {
                const oldVolume = audioPlayer.volume;
                audioPlayer.volume = Math.min(oldVolume * 1.3, 1.0);
                
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≥—Ä–æ–º–∫–æ—Å—Ç—å —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    audioPlayer.volume = oldVolume;
                }, 3000);
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
            launchConfetti();
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –≤ Telegram Web App)
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.sendData(JSON.stringify({
                    action: 'accepted',
                    name: invitationData.her_name,
                    timestamp: new Date().toISOString()
                }));
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
            localStorage.setItem('invitation_accepted', 'true');
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }, 5000);
        }
        
        // –≠—Ñ—Ñ–µ–∫—Ç –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
        function launchConfetti() {
            const colors = ['#8774e1', '#ff6b9d', '#4CAF50', '#FFC107', '#2196F3'];
            
            for (let i = 0; i < 80; i++) {
                createConfettiPiece(colors);
            }
        }
        
        function createConfettiPiece(colors) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            
            // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –≤–≤–µ—Ä—Ö—É
            confetti.style.left = Math.random() * 100 + 'vw';
            confetti.style.top = '-20px';
            
            // –°–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            
            // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ —Ñ–æ—Ä–º–∞
            const size = 8 + Math.random() * 12;
            confetti.style.width = size + 'px';
            confetti.style.height = size + 'px';
            confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
            
            document.body.appendChild(confetti);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            const animation = confetti.animate([
                { 
                    opacity: 0,
                    transform: 'translateY(0) rotate(0deg)'
                },
                { 
                    opacity: 1,
                    transform: `translateY(${20 + Math.random() * 20}px) rotate(180deg)`
                },
                { 
                    opacity: 1,
                    transform: `translateY(${window.innerHeight}px) rotate(${360 + Math.random() * 360}deg)`
                }
            ], {
                duration: 2000 + Math.random() * 2000,
                easing: 'cubic-bezier(0.215, 0.610, 0.355, 1)'
            });
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            animation.onfinish = () => confetti.remove();
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ Enter –¥–ª—è –ø–∞—Ä–æ–ª—è
        document.getElementById('password-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') checkPassword();
        });
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª–æ –ª–∏ —É–∂–µ –ø—Ä–∏–Ω—è—Ç–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
        if (localStorage.getItem('invitation_accepted') === 'true') {
            console.log("‚úÖ –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ —É–∂–µ –±—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–∞–Ω–µ–µ");
        }
    </script>
</body>
</html>